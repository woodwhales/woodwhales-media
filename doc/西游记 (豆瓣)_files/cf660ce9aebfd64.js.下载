
        Do(function() {
            if (window.__init_review_list) return;
            __init_review_list = true;
                window.is_released = true
                window.txt_released = '该剧尚未播出，不能投票噢'
            var _URL_MANIFEST = 'https://img3.doubanio.com/f/zerkalo/6c72ca62398dd1181a2ad3a2bc198adfde533dc2/js/review/editor/ng/manifest.js';
            var _URL_VENDOR = 'https://img3.doubanio.com/f/zerkalo/af7b34253d2668a25e74b93aac799a5d36be8608/js/review/editor/ng/vendor.js';
            var _URL_SETTING_JS = 'https://img3.doubanio.com/f/zerkalo/15d9946020b920d461603860b5b9430109a772e5/js/review/editor/ng/setting_standalone.js';
            var _URL_SETTING_CSS = 'https://img3.doubanio.com/f/zerkalo/b45d0d25013ec05ba5a2d47ccacb7d3518ee22a2/css/review/editor/ng/setting_standalone.css';

            !function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var a in t)e.d(n,a,function(e){return t[e]}.bind(null,a));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=133)}({128:function(t,e,i){"use strict";function n(t,e){void 0===e&&(e=document.body);var i=[];if(!e)return null;var n=e.querySelectorAll("img[data-render-type=gif]");if(n&&0!==n.length){for(var a,r,s=0,l=(t&&"video"===t.type&&(r=document.createElement("video")).canPlayType&&r.canPlayType("video/mp4")&&(!(Object(o.i)()&&!Object(o.d)())||"playsInline"in r)),p={download:!t||t.download,clickPlay:!!t&&t.clickPlay};a=n[s];){var u=l?new y(a,p):new h(a,p);i.push(u),s++}if("object"==typeof t&&"preloadNum"in t)for(var d=Math.min(t.preloadNum,i.length);d--;)i[d]&&i[d].play();return g=f(g,i),i}}i.d(e,"a",function(){return n});var a,o=i(23),r=function(t,e,i){return t.addEventListener?(t.addEventListener(e,i,!1),{remove:function(){t.removeEventListener(e,i,!1)}}):t.attachEvent?(t.attachEvent("on"+e,i),{remove:function(){t.detachEvent("on"+e,i)}}):void 0};!function(t){t.default="default",t.loading="loading",t.triggered="triggered",t.playing="playing",t.pause="pause",t.error="error",t.timeout="timeout"}(a||(a={}));var s,l={download:!0,prefetch:!0,clickPlay:!1,timeout:1e4},p=function(){function t(t,e){var i=this;return t?void(this.inited||t.getAttribute("data-inited")||(this.config=Object.assign({},l,e),this.elem=t,this.container=t.parentElement,this.previewURL=this.elem.src,this.playURL=this.getPlayURL(),this.config.clickPlay&&this.elem&&(this.elemClick=r(this.elem,"click",function(t){var e=i.status===a.playing,n=i.status===a.default,o=i.status===a.pause,r=i.status===a.error,s=i.status===a.loading;(n||o)&&t.stopPropagation(),e||r||s||i.playHandle(t,!0)})),this.init())):null}return t.prototype.init=function(){},t.prototype.getOriginURL=function(t){return(t||this.elem).getAttribute("data-original-url")},t.prototype.getPlayURL=function(t){return this.getOriginURL()},t.prototype.createDownloadButton=function(t){if(this.config.download){var e=document.createElement("a");e.className="image-gif-download",e.href=t||this.getOriginURL(),e.target="_blank",e.rel="norefer",e.innerHTML="GIF",this.container&&this.container.appendChild(e),this.downloadButton=e}},t.prototype.createPanel=function(){this.panel||(this.panel=document.createElement("div"),this.panel.className="image-gif-panel",this.panel.innerHTML='\n      <div class="image-gif-panel-inner">\n        <a href="javascript:;" class="image-gif-button-play">GIF</a>\n        <a href="javascript:;" class="image-gif-button-reload" style="display: none">重新加载</a>\n        <span class="image-gif-loading" style="display: none;">加载中</span>\n      </div>\n    ',this.container.appendChild(this.panel),this.playButton=this.panel.getElementsByClassName("image-gif-button-play")[0],this.reloadButton=this.panel.getElementsByClassName("image-gif-button-reload")[0],this.loadingIcon=this.panel.getElementsByClassName("image-gif-loading")[0],this.playButtonClick=r(this.playButton,"click",this.playHandle.bind(this)),this.reloadButtonClick=r(this.reloadButton,"click",this.reloadHandle.bind(this)),this.elem.setAttribute("data-inited","true"))},t.prototype.play=function(t){},t.prototype.playHandle=function(t,e){this.play(this.playURL),this.changeStatus(a.playing)},t.prototype.changeStatus=function(t){this.status=t,this.elem&&this.elem.setAttribute("data-status",t)},t.prototype.reloadHandle=function(t){this.changeStatus(a.loading),this.playButton.style.display="none",this.reloadButton.style.display="none",this.loadingIcon.style.display="block";var e="_r="+Math.random(),i=this.playURL.indexOf("?")>=0?this.playURL+"&"+e:this.playURL+"?"+e;this.playURL=i,this.play(this.playURL)},t.prototype.notFoundHandle=function(t){},t.prototype.pause=function(){},t.prototype.destroy=function(){},t.prototype.startTimeout=function(){var t=this,e=this.config.timeout,i=void 0===e?1e4:e;this.timer=setTimeout(function(){t.status===a.loading&&t.changeStatus(a.timeout)},i)},t.prototype.clearTimeout=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype._destory=function(){this.container&&(this.panel&&(this.container.removeChild(this.panel),this.panel=null),this.downloadButton&&(this.container.removeChild(this.downloadButton),this.downloadButton=null)),this.elem&&this.elem.setAttribute("data-inited",""),this.inited=!1,this.changeStatus(a.default)},t.prefetch=function(t){if(!t)return!1;var e=document.createElement("link");e.rel="prefecth",e.href=t;var i=document.getElementsByTagName("link")[0];i?i.parentNode.insertBefore(e,i):document.getElementsByTagName("head")[0].appendChild(e)},t}(),u=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.init=function(){this.createPanel(),this.playURL=this.getPlayURL(),this.imgLoad=r(this.elem,"load",this.loadedHandle.bind(this)),this.imgLoadErorr=r(this.elem,"error",this.notFoundHandle.bind(this)),this.config&&this.config.prefetch&&p.prefetch(this.getPlayURL()),this.elem&&(this.srcTemp=this.elem.getAttribute("src"))},e.prototype.loadedHandle=function(){return!!this.elem&&void(this.elem.src===this.playURL&&(this.playButtonClick.remove(),this.reloadButtonClick.remove(),this.imgLoad.remove(),this.imgLoadErorr.remove(),this.container.removeChild(this.panel),this.createDownloadButton(),this.changeStatus(a.playing)))},e.prototype.notFoundHandle=function(){return!!this.elem&&(this.elem.src=this.previewURL,this.playButton.style.display="none",this.reloadButton.style.display="block",this.loadingIcon.style.display="none",this.changeStatus(a.error),void 0)},e.prototype.play=function(t){return!!this.elem&&(this.elem.src=t||this.playURL,this.playButton.style.display="none",this.reloadButton.style.display="none",this.loadingIcon.style.display="block",void 0)},e.prototype.pause=function(){this.elem&&this.srcTemp&&this.elem.setAttribute("src",this.srcTemp),this.changeStatus(a.pause)},e.prototype.destroy=function(){this.pause(),this._destory()},e}(p),d=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),c=Object(o.b)(),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.init=function(){var t=this;this.imageLoaded=!1,this.needPlay=!1,this.createPanel(),this.container.setAttribute("data-render-type","video"),this.elem&&(this.elem.complete?this._playAfterComplete():this.elem.addEventListener("load",function(){t._playAfterComplete()})),e.allInstances.push(this),this.startTimeout()},e.prototype._playAfterComplete=function(){this.imageLoaded=!0,this.needPlay&&(this.createPlayer(),this.bindPlayerEvents(),this.play())},e.prototype.playingHandle=function(){this.status!==a.playing&&(this.changeStatus(a.playing),this.playButton&&(this.playButton.style.display="none"),this.reloadButton&&(this.reloadButton.style.display="none"),this.loadingIcon&&(this.loadingIcon.style.display="none"),this.player&&(this.player.style.display="block"),this.playButtonClick.remove(),this.reloadButtonClick.remove(),this.container.removeChild(this.panel),this.panel=null,this.playerLoadStart.remove(),this.playerPlaying.remove(),this.playerReady.remove(),this.playerLoadedData.remove(),this.playerLoadedMetaData.remove(),this.changeStatus(a.playing),this.createDownloadButton(),this.clearTimeout())},e.prototype.changeStatus=function(t){this.status=t,this.elem&&this.elem.setAttribute("data-status",t),this.player&&this.player.setAttribute("data-status",t)},e.prototype.getPlayURL=function(t){var e=(t||this.elem).getAttribute("data-original-url");if(!e)return"";var i=e.split(".").pop();return e.replace(new RegExp("."+i+"$","gi"),".mp4")},e.prototype.createPlayer=function(){if(!this.imageLoaded)return!1;var t=document.createElement("video");this.container.appendChild(t),t.className="image-gif-player",t.muted=!0,t.controls=!1,t.loop=!c,t.preload="auto",t.autoplay=!0,t.poster=this.previewURL,t.crossOrigin="anonymous",t.playsinline=!0,t.style.display="none",t.setAttribute("playsinline","true"),t.setAttribute("webkit-playsinline","true"),t.setAttribute("type","video/mp4");try{var e=this.playURL;t.src=e}catch(e){console&&console.error("不支持该 player.src",t.src)}this.loadingIcon.style.display="block",this.playButton.style.display="none",this.player=t},e.prototype.bindPlayerEvents=function(){var t=this;this.playerLoadStart=r(this.player,"loadstart",function(e){t.changeStatus(a.loading)}),this.playerReady=r(this.player,"canplay",function(){t.canPlay=!0,t.status!==a.playing&&t.play()}),this.playerLoadedMetaData=r(this.player,"loadedmetadata",function(){t.canPlay=!0,t.status!==a.playing&&t.play()}),this.playerLoadedData=r(this.player,"loadeddata",function(){t.canPlay=!0}),c&&(this.playerTrickLoop=r(this.player,"ended",function(){t.player.currentTime=.01,t.player.play()})),this.playerPlaying=r(this.player,"playing",this.playingHandle.bind(this)),this.playerLoadError=r(this.player,"error",this.notFoundHandle.bind(this))},e.prototype.playHandle=function(t,e){t&&t.preventDefault(),t&&e&&t.stopPropagation(),this.canPlay=!0,this.play(this.playURL),this.changeStatus(a.loading)},e.prototype.play=function(t){return this.needPlay=!0,!!this.imageLoaded&&(this.player||(this.createPlayer(),this.bindPlayerEvents()),!!this.canPlay&&(t&&this.player&&(this.player.src=t),void(this.player&&(this.player.play(),this.changeStatus(a.triggered)))))},e.prototype.reloadHandle=function(t){t&&t.preventDefault(),t&&t.stopPropagation(),this.changeStatus(a.loading),this.playButton&&(this.playButton.style.display="none"),this.reloadButton&&(this.reloadButton.style.display="none"),this.loadingIcon&&(this.loadingIcon.style.display="block");var e=this.playURL;this.canPlay=!0,this.play(e)},e.prototype.notFoundHandle=function(t){return this.status!==a.playing&&(this.canPlay=!1,this.playButton&&(this.playButton.style.display="none"),this.reloadButton&&(this.reloadButton.style.display="block"),this.loadingIcon&&(this.loadingIcon.style.display="none"),this.player&&(this.player.style.display="none"),this.changeStatus(a.error),void 0)},e.prototype.pause=function(){this.player&&(this.player.pause(),this.changeStatus(a.pause))},e.prototype.destroy=function(){this.container&&this.player&&(this.container.removeChild(this.player),this.player=null),this._destory()},e.allInstances=[],e.ALL_PLAY=function(){e.allInstances&&e.allInstances.forEach(function(t){"playing"!==t.status&&(t.canPlay=!0,t.play())})},e}(p),f=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var o=arguments[e],r=0,s=o.length;r<s;r++,a++)n[a]=o[r];return n},g=[]},133:function(t,e,i){"use strict";i.r(e),i(134);var n=i(128);window._IMAGE_GIF_RENDER=n.a},134:function(t,e,i){},23:function(t,e,i){"use strict";function n(t){var e=navigator.userAgent||"";return t.test(e)}function a(t){return function(){return n(t)}}i.d(e,"k",function(){return o}),i.d(e,"j",function(){return r}),i.d(e,"l",function(){return s}),i.d(e,"c",function(){return l}),i.d(e,"f",function(){return p}),i.d(e,"g",function(){return u}),i.d(e,"b",function(){return h}),i.d(e,"i",function(){return d}),i.d(e,"d",function(){return c}),i.d(e,"h",function(){return y}),i.d(e,"e",function(){return f}),i.d(e,"a",function(){return g});var o=function(){return n(/micromessenger/i)&&!n(/wxwork/gi)},r=a(/weibo/i),s=a(/xiaomi/i),l=a(/baiduboxapp|baidubrowser/i),p=a(/iphone|ipad|ipod/i),u=function(){return n(/iphone/i)&&812===screen.height&&375===screen.width},h=a(/android/i),d=a(/(iphone|ipod|((?:android)?.*?mobile)|blackberrynokia)/i),c=a(/com\.douban\.frodo/i),y=a(/miniprogram/i),f=a(/(com\.douban\.frodo\/[\d.]+(dev|debug|test|beta|alpha))|(com\.douban\.frodo\.test)/i),g={isWeixin:o,isWeibo:r,isXiaomi:s,isBaidu:l,isIOS:p,isIphoneX:u,isAndroid:h,isMobile:d,isFrodo:c,isMiniProgram:y,isFrodoPre:f}}});
            !function(){function t(t,e){return function(){var i=R[e],o=this;i&&clearTimeout(i),R[e]=setTimeout(function(){t.apply(o,arguments)},300)}}var e=8,i=window.dui||{},o="dui-dialog",n=[],s=null,h=!(!$.browser||!$.browser.msie||"6.0"!==$.browser.version),d=("ontouchstart"in window,{}),a={},c="j_close_dialog",l="dui-dialog",r="dui-dialog-close",u="dui-dialog-shd",f="dui-dialog-content",p="dui-dialog-iframe",m="dui-dialog-msk",g="确定",v="取消",b="提示",w="下载中，请稍候...",y='<div id="{ID}" class="'+l+' {CLS}" style="{CSS_ISHIDE}">                <span class="'+u+'"></span>                <div class="'+f+'">                    {BN_CLOSE}                    {TITLE}                    <div class="bd">{BODY}</div>                </div>            </div>',C='<a href="#" class="'+c+" "+r+'">X</a>',I='<div class="hd"><h3>{TITLE}</h3></div>',k='<iframe class="'+p+'"></iframe>',x='<div class="'+m+'"></div>',T={confirm:{text:g,method:function(t){t.close()}},cancel:{text:v,method:function(t){t.close()}}},S={url:"",nodeId:"",cls:"",content:"",title:b,width:0,height:0,visible:!1,modal:!1,iframe:!1,maxWidth:960,autoupdate:!1,cache:!0,buttons:[],callback:null,dataType:"text",isStick:!1,isHideClose:!1,isHideTitle:!1},H=function(t,e){var i,o={};for(i in e)e.hasOwnProperty(i)&&(o[i]=void 0===t[i]?e[i]:t[i]);return o},D=function(t){for(var e,i=t.elements,o=0,n=[],s={"select-one":function(t){return encodeURIComponent(t.name)+"="+encodeURIComponent(t.options[t.selectedIndex].value)},"select-multiple":function(t){for(var e,i=0,o=[];e=t.options[i++];)e.selected&&o.push(encodeURIComponent(t.name)+"="+encodeURIComponent(e.value));return o.join("&")},radio:function(t){if(t.checked)return encodeURIComponent(t.name)+"="+encodeURIComponent(t.value)},checkbox:function(t){if(t.checked)return encodeURIComponent(t.name)+"="+encodeURIComponent(t.value)}};e=i[o++];)s[e.type]?n.push(s[e.type](e)):n.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value));return n.join("&").replace(/\&{2,}/g,"&")},j=function(t){var e=t||{};this.config=H(e,S),this.init()};j.prototype={init:function(){if(this.config)return this.render(),this.bind(),this},render:function(t){var e=this.config,i=e.nodeId||o+n.length;n.push(i);var s=$("body"),h=s.find("."+m),d="object"==typeof e.content?$(e.content).html():e.content;return s.append(y.replace("{ID}",i).replace("{CSS_ISHIDE}",e.visible?"":"visibility:hidden;top:-999em;left:-999em;").replace("{CLS}",e.cls).replace("{TITLE}",I.replace("{TITLE}",e.title)).replace("{BN_CLOSE}",C).replace("{BODY}",d||t||"")),e.modal&&!h.length?(s.append(x),this.msk=$("."+m)):this.msk=h.eq(0),this.nodeId=i,this.node=$("#"+i),this.title=$(".hd",this.node),this.body=$(".bd",this.node),this.btnClose=$("."+r,this.node),this.shadow=$("."+u,this.node),this.iframe=$("."+p,this.node),this.set(e),this},bind:function(){var e=this;return h||$(window).bind({resize:t(function(){e.updatePosition()},"pos"),scroll:t(function(){e.updatePosition()},"pos")}),e.node.delegate("."+c,"click",function(t){e.close(),t.preventDefault()}),e.node.find("."+r).bind("click",function(t){e.close(),t.preventDefault()}),$("body").keypress(function(t){27===t.keyCode&&e.close()}),this},updateSize:function(){var t,i=this.node.width(),o=$(window).width(),n=$(window).height(),s=this.config;$(".bd",this.node).css({height:"auto","overflow-x":"visible","overflow-y":"visible"}),t=this.node.height();var h=2*e;return s.maxWidth=Math.min(s.maxWidth,o-h),i>s.maxWidth&&(i=s.maxWidth,this.node.css("width",i+"px")),t>n&&$(".bd",this.node).css({height:n-150+"px","overflow-x":"hidden","overflow-y":"auto"}),t=this.node.height(),this.shadow.width(i),this.shadow.height(t),this.iframe.width(i+h).height(t+h),this},updatePosition:function(){if(!this.config.isStick){var t=this.node.width(),i=this.node.height(),o=$(window),n=h?o.scrollTop():0;return this.node.css({left:Math.floor(o.width()/2-t/2)+"px",top:Math.floor(o.height()/2-i/2-e)+n+"px"}),this}},set:function(t){var e,i,o=this.nodeId,n=this.nodeId||n,s=[],h=this,c=function(t){return s.push(0),o+"-"+t+"-"+s.length};if(!t)return this;t.width&&(this.node.css("width",t.width+"px"),this.config.width=t.width),t.height&&(this.node.css("height",t.height+"px"),this.config.height=t.height),$.isArray(t.buttons)&&t.buttons[0]?(i=$(".ft",this.node),e=[],$(t.buttons).each(function(){var t=arguments[1],i=c("bn");"string"==typeof t&&(t=T[t]),t.text&&(t.href?e.push('<a class="'+(t.cls||"")+'" id="'+i+'" href="'+t.href+'">'+t.text+"</a> "):e.push('<span class="bn-flat '+(t.cls||"")+'"><input type="button" id="'+i+'" class="'+n+'-bn" value="'+t.text+'" /></span> '),a[i]=t.method)}),i[0]?i.html(e.join("")):i=this.body.parent().append('<div class="ft">'+e.join("")+"</div>"),this.footer=$(".ft",this.node),$(".ft input, .ft a",this.node).click(function(t){var e=this.id&&a[this.id];if(e)var i=e.call(this,h);i&&(t.preventDefault(),"string"==typeof i&&alert(i))})):(this.footer=$(".ft",this.node),this.footer.html("")),"undefined"!=typeof t.isHideClose&&(t.isHideClose?this.btnClose.hide():this.btnClose.show(),this.config.isHideClose=t.isHideClose),"undefined"!=typeof t.isHideTitle&&(t.isHideTitle?this.title.hide():this.title.show(),this.config.isHideTitle=t.isHideTitle),t.title&&(this.setTitle(t.title),this.config.title=t.title),"undefined"!=typeof t.iframe&&(t.iframe?this.iframe[0]?this.iframe.show():(this.node.prepend(k),this.iframe=$("."+p,this.node)):this.iframe.hide(),this.config.iframe=t.iframe),t.content&&(this.body.html("object"==typeof t.content?$(t.content).html():t.content),this.config.content=t.content),t.url&&(t.cache&&d[t.url]?("text"!==t.dataType&&t.dataType||this.setContent(d[t.url]),t.callback&&t.callback(d[t.url],this)):"json"===t.dataType?(this.setContent(w),this.footer&&this.footer.hide(),$.getJSON(t.url,function(e){h.footer.show(),d[t.url]=e,t.callback&&t.callback(e,h)})):(this.setContent(w),this.footer&&this.footer.hide(),$.ajax({url:t.url,dataType:t.dataType,success:function(e){d[t.url]=e,h.footer&&h.footer.show(),h.setContent(e),t.callback&&t.callback(e,h)}})));var l=t.position;return l&&this.node.css({left:l[0]+"px",top:l[1]+"px"}),"boolean"==typeof t.autoupdate&&(this.config.autoupdate=t.autoupdate),"boolean"==typeof t.isStick&&(t.isStick?this.node.css("position","absolute"):this.node.css("position","fixed"),this.config.isStick=t.isStick),this.update()},update:function(){return this.updateSize(),this.updatePosition(),this},setContent:function(t){return this.body.html(t),this.update()},setTitle:function(t){return $("h3",this.title).html(t),this},submit:function(t){var e=$("form",this.node);e.submit(function(e){e.preventDefault();var i=this.getAttribute("action",2),o=this.getAttribute("method")||"get",n=D(this);$[o.toLowerCase()](i,n,function(e){t&&t(e)},"json")}),e.submit()},open:function(){this.node.appendTo("body").css("visibility","visible").show();var t=this,e=this.config,i=t.body[0];return t.contentHeight=i.offsetHeight,this.watcher=e.autoupdate?setInterval(function(){i.offsetHeight!==t.contentHeight&&(t.update(),t.contentHeight=i.offsetHeight)},100):0,e.modal&&this.msk.show().css({height:$(document).height()}),this},close:function(){return this.node.hide(),this.msk.hide(),this.node.trigger("dialog:close",this),clearInterval(this.watcher),this}},i.Dialog=function(t,e){return!e&&s?t?s.set(t):s:s||e?new j(t):s=new j(t)},window.dui=i;var R={}}();
            "use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),visible=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;_classCallCheck(this,e),this.container=t,this.containerHeight=t.innerHeight,this.eleList=[],this.lastVisibleEle=null,this.cbs=[],this.__start()}return _createClass(e,[{key:"__start",value:function(){var e=this;this.container.addEventListener("scroll",function(){e.__detect()}),this.container.addEventListener("resize",function(){e.containerHeight=e.container.innerHeight,e.__detect()})}},{key:"__detect",value:function(){var e=this;if(!this.eleList.length&&this.lastVisibleEle){if(null===this.lastVisibleEle)return;return this.cbs.forEach(function(t){return t(e.lastVisibleEle,null)}),void(this.lastVisibleEle=null)}var t=this.eleList.filter(function(t){var i=t.getBoundingClientRect();return i.top<e.containerHeight&&e.containerHeight<i.bottom});if(0===t.length){if(null===this.lastVisibleEle)return;this.cbs.forEach(function(t){return t(e.lastVisibleEle,null)}),this.lastVisibleEle=null}else{if(this.lastVisibleEle===t[0])return;this.cbs.forEach(function(i){return i(e.lastVisibleEle,t[0])}),this.lastVisibleEle=t[0]}}},{key:"onChange",value:function(e){this.cbs.push(e)}},{key:"add",value:function(e){this.eleList.push(e),this.__detect()}},{key:"remove",value:function(e){this.eleList.splice(this.eleList.indexOf(e),1),this.__detect()}}]),e}();Do.ready(function(){"_REVIEW_COPY_OPTIONS"in window||(_REVIEW_COPY_OPTIONS={targetNode:".review-content",handleCopy:function(e,t){var i=t.data();if(i&&i.original){var n=["版权归作者所有，任何形式转载请联系作者。","作者："+i.author+"（来自豆瓣）","来源："+i.url,"\n\n"].join("\r\n");return n+e}}},function(e){if("undefined"!=typeof e){var t=function(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().htmlText.replace(/<br>/gi,"\r\n"):""},i=function(e,t){if(e)try{if(e.setData("Text",t),e.getData("Text").length>0)return}catch(i){if(e.setData("text/plain",t),e.getData("text/plain").length>0)return}var i=$("<div>").css({position:"absolute",left:"-99999px"}).appendTo("body");i.html(t),window.getSelection().selectAllChildren(i[0]),window.setTimeout(function(){i.remove()},200)};$("body").delegate(e.targetNode,"copy cut",function(n){var o=t();if(!(o.length<=42)){var r=e.handleCopy&&e.handleCopy(o,$(this))||null;if(r){n.preventDefault();var s=n.originalEvent.clipboardData||window.clipboardData;i(s,r)}}})}}(window._REVIEW_COPY_OPTIONS))}),function(){function e(e,t,i){var n=$("#r-useful_count-"+t),o=$("#r-useless_count-"+t);n.text(0===e.useful_count?"":e.useful_count),o.text(0===e.useless_count?"":e.useless_count),"useful"===i?(n.prev().attr("src",window.usefuled_icon),o.prev().attr("src",window.useless_icon)):(n.prev().attr("src",window.useful_icon),o.prev().attr("src",window.uselessed_icon))}function t(e,t){$("#review_"+e+"_short").addClass("hidden"),$("#review_"+e+"_full").removeClass("hidden").addClass("loaded"),t&&$("#review_"+e+"_full_content").html(t),$(".review-item#"+e+" .action .fold").removeClass("hidden"),l(document),s()}function i(e){$("#review_"+e+"_short").removeClass("hidden"),$("#review_"+e+"_full").addClass("hidden"),$("#"+e).get(0).scrollIntoViewIfNeeded(),$("#review_"+e+"_short").find(".unfold").text("展开"),$("#"+e).find(".action-placeholder").remove(),$("#"+e).find(".action").removeClass("fixed-action"),$("#"+e).find(".action .fold").addClass("hidden")}Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){e=0===arguments.length||!!e;var t=this.parentNode,i=window.getComputedStyle(t,null),n=parseInt(i.getPropertyValue("border-top-width")),o=parseInt(i.getPropertyValue("border-left-width")),r=this.offsetTop-t.offsetTop<t.scrollTop,s=this.offsetTop-t.offsetTop+this.clientHeight-n>t.scrollTop+t.clientHeight,l=this.offsetLeft-t.offsetLeft<t.scrollLeft,a=this.offsetLeft-t.offsetLeft+this.clientWidth-o>t.scrollLeft+t.clientWidth,c=r&&!s;(r||s)&&e&&(t.scrollTop=this.offsetTop-t.offsetTop-t.clientHeight/2-n+this.clientHeight/2),(l||a)&&e&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-t.clientWidth/2-o+this.clientWidth/2),(r||s||l||a)&&!e&&this.scrollIntoView(c)});var n=new visible,o=window.is_released,r=window.txt_released||"";n.onChange(function(e,t){if(e&&($(e).find(".action").removeClass("fixed-action").css({width:"auto",left:"auto"}),$(e).find(".action-placeholder").remove()),t){$(t).append('<div class="action-placeholder" style="height: 46px;"></div>');var i=$(t).find(".action");i.addClass("fixed-action"),i.css({width:$(t).width()+"px",left:t.getBoundingClientRect().left+"px"})}});var s=function(){return"_IMAGE_GIF_RENDER"in window&&setTimeout(function(){return window._IMAGE_GIF_RENDER()},300)},l=function(){for(var e={useful_count:["有用","/j/review/{REVIEW_ID}/useful"],useless_count:["没用","/j/review/{REVIEW_ID}/useless"],spoiler:["剧透提醒已提交，谢谢","/j/review/{REVIEW_ID}/spoiler"]},t=/disabled/,i=/(\w+_count)/,n=/spoiler/,o=get_cookie("ck"),r=document.querySelectorAll(".main-panel-useful"),s=null,l="",a=function(e){return e&&"true"===e.getAttribute("data-is_owner")},c=function(e){return e&&"true"===e.getAttribute("data-can_vote")},d=function(e){return e&&"true"===e.getAttribute("data-is_tv")},u=function(r){if(console.log("tyeset"),o){r.stopPropagation();var s=r.target,u=s.className,v=u.match(i)||u.match(n),w="",_="",g="";if(!u.match(t)){if(v){if(a(r.currentTarget))return alert("不能给自己投票噢");if(!c(r.currentTarget)){var p=d(r.currentTarget)?"该剧尚未播出，不能投票噢":"该电影还未上映，不能投票噢";return alert(p)}w=v[0],g=e[w][0],_=e[w][1],l=r.currentTarget.getAttribute("data-rid"),_=_.replace("{REVIEW_ID}",l)}else if(!v||!l)return;var b=$.post(_,{ck:o},function(e){if(0==e.r){if("spoiler"===w)return f();h(e,w)}});b.fail(function(){alert("网络错误")}).always(function(){})}}},f=function(t){var i=document.getElementById(l),n=i.querySelector(".spoiler");n.innerText=e.spoiler[0],n.className=n.className.replace("not-reported","disabled")},h=function(i,n){var o=document.getElementById(l);for(var r in e)if(void 0!==i[r]){var s=e[r][0]+" "+i[r],a=o.querySelector("."+r),c=a.className;(r===n||r!==n&&c.match(t))&&a.classList.toggle("disabled"),a.innerHTML=s}},v=r.length,w=0;w<v;w++)s=r[w],s&&s.addEventListener("click",u,!1)};$("body").delegate(".review-item .action .up","click",function(){if(window._USER_ABNORMAL)return void(show_abnormal&&show_abnormal());var t=$(this).data("rid");return!o&&r?void alert(r):void $.post("/j/review/"+t+"/useful",{ck:get_cookie("ck")},function(i){e(i,t,"useful")})}),$("body").delegate(".review-item .action .down","click",function(){if(window._USER_ABNORMAL)return void(show_abnormal&&show_abnormal());var t=$(this).data("rid");return!o&&r?void alert(r):void $.post("/j/review/"+t+"/useless",{ck:get_cookie("ck")},function(i){e(i,t,"useless")})}),$("body").delegate(".review-short","click",function(){var e=this,i=$(this).data("rid");return $(this).data("loaded")?(t(i),void n.add($(this).closest(".review-item").get(0))):void($(this).data("loading")||($(this).data("loading",!0),$(this).find(".unfold").text("加载中..."),$.getJSON("/j/review/"+i+"/full",{},function(o){t(i,o.body),$(e).data("loading",!1).data("loaded",!0),n.add($(e).closest(".review-item").get(0)),$(e).closest(".review-item").find(".action-btn.up img").attr("src",o.votes.is_useful?window.usefuled_icon:window.useful_icon),$(e).closest(".review-item").find(".action-btn.down img").attr("src",o.votes.is_useless?window.uselessed_icon:window.useless_icon)})))}),$("body").delegate(".action .fold","click",function(){var e=$(this).closest(".review-item").find(".review-short").data("rid");i(e)}),$("body").delegate("a.report","click",function(){var e=$(this).siblings(".review-content").data("url");generate_report_dialog({report_url:e,type:["subject"]})})}();
            $(function(){$("body").delegate(".btn-unfold","click",function(e){e.preventDefault();var n=$(e.target),t=n.parent(".fold-hd");t.slideUp().next().slideDown()})});
        });

        window.useful_icon = "https://img3.doubanio.com/f/zerkalo/536fd337139250b5fb3cf9e79cb65c6193f8b20b/pics/up.png";
        window.usefuled_icon = "https://img3.doubanio.com/f/zerkalo/635290bb14771c97270037be21ad50514d57acc3/pics/up-full.png";
        window.useless_icon = "https://img3.doubanio.com/f/zerkalo/68849027911140623cf338c9845893c4566db851/pics/down.png";
        window.uselessed_icon = "https://img3.doubanio.com/f/zerkalo/23cee7343568ca814238f5ef18bf8aadbe959df2/pics/down-full.png";

    
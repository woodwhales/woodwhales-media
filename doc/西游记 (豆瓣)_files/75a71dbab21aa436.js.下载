
        !function(t,i){t.fn.fixSide=function(e,n){function o(){u||(u=setTimeout(function(){var o=h.offset().left+(r.clientWidth-a.clientWidth),s=r.getBoundingClientRect().top,c=document.body.clientHeight,p=l.parent().height(),b=t(i).height(),g=window.scrollY,w=c-(g+b)<=e;d=a.clientHeight,f=d+n>=b,d>=p||g<=b?l.css({position:"static"}):f||w?s<0&&Math.abs(s)+b-e>d?l.css({position:"fixed",left:o+"px",right:"auto",bottom:e+"px",top:"auto"}):Math.abs(s)+b-e<d&&l.css({position:"static"}):s<0&&l.css({position:"fixed",left:o+"px",right:"auto",top:n+"px",bottom:"auto"}),clearTimeout(u),u=null},20))}var s=/ipod|iphone|ipad|android|blackberry|mobile|webos|windows phone/i.test(navigator.userAgent),c="",l="",a="",d="",r="",h="",f="",u=null;t.browser.ie&&t.browser.version|!0||s||(c=t(i).height(),l=t("#content .aside"),a=l[0],d=a.clientHeight,r=t("#content")[0],h=t("#content .article"),f=d+n>c,i.addEventListener("load",function(){d=a.clientHeight,r=t("#content")[0],f=d+n>=c}),t(i).bind("scroll",o),t(i).bind("resize",function(t){var i=h.offset().left+(r.clientWidth-a.clientWidth);l.css({left:i+"px"})}))}}(jQuery,window);;
        $().fixSide(300, 52);
    ;
$(function(){
    var $actor_list = $('#info .actor a');
    var $actor_attr = $('#info .actor .attrs');

    if ($actor_list.length > 5) {
        $actor_attr.empty();

        $actor_list.each(function(idx){
            if (idx+1 === $actor_list.length) {
                $('<span></span>').prepend($(this)).appendTo($actor_attr);
            } else {
                $('<span> / </span>').prepend($(this)).appendTo($actor_attr);
            }
        });

        $('<a href="javascript:;" class="more-actor" title="更多主演">更多...</a>').on('click', function(){
            $actor_attr.find('span').show();
            $(this).hide();
        }).appendTo($actor_attr);

        $actor_attr.find('span').eq(4).nextAll('span').hide();
    }
})
;
            $(function(){function e(){var e=document.createElement("iframe");$iframe=$(e);var t=/\/subject\/(\d+)\/photos/g,o=window.subject_id||window.answerObj&&window.answerObj.SUBJECT_ID||$("#mainpic a.nbgnbg").attr("href").match(t)[0].replace("/subject/","").replace("/photos","");$iframe.css({position:"absolute",top:-1e4,left:-1e4}),$iframe.attr("src","/subject/"+o+"/output_card"),$iframe.appendTo($("body")),a.push($iframe)}function t(){for(f.text("引用");a.length>0;){var e=a.pop();e.remove()}}var a=[],o=navigator.userAgent,r=o.indexOf("Chrome")>-1,n=(o.indexOf("MSIE")>-1,o.indexOf("Firefox")>-1),i=o.indexOf("Safari")>-1;r&&i&&(i=!1);var c=$(".output-btn-wrap"),f=$(".download-output-image");r||n?c.css({display:""}):c.remove(),f.click(function(t){t.preventDefault(),f.text("正在生成..."),e()}),window.__output_card={download_image:e,close_iframes:t}});
          ;
$(function(){
    $(".episode_list").delegate(".ep_more","click",function(){
        $(".episode_list").find(".hide").css("display","inline-block");
        $(this).hide();
        return false;
    })
})
;
Do(
  'https://img3.doubanio.com/f/shire/0f71bdb40585e869195aea6beee3ed04879c8e8e/js/lib/es5-polyfills.js',
  'https://img3.doubanio.com/f/movie/c7d6644d315d980333c64c04211e62e87a34dbcd/js/movie/lib/react.min.js',
  'https://img3.doubanio.com/f/movie/d61288cc4105ce8dea909962536609eb73ea715a/js/movie/lib/react-dom.min.js',
  function() {
    var EpisodeDiscussion=React.createClass({displayName:"EpisodeDiscussion",getInitialState:function(){return{content:'<p class="mv-dicussion-loading">加载中...'}},getDefaultProps:function(){return{containerCSS:"discussion-list",loadedError:"加载失败..."}},setContent:function(t){this.setState({content:t})},fetch:function(t){this.setState({count:0}),t&&this.setProps({id:t}),$.ajax({method:"get",dataType:"json",url:this.props.dataSource,data:{ep_id:this.props.id},success:function(t){return t.r?void this.setContent('<div class="discussion-error-loaded">'+this.props.loadedError+"</div>"):void this.setState({count:t.count,content:t.html})}.bind(this),error:function(){this.setContent('<div class="discussion-error-loaded">'+this.props.loadedError+"</div>")}.bind(this)})},onUpdated:function(t){this.state.onUpdated=t},componentDidMount:function(){this.props.id&&this.fetch()},componentDidUpdate:function(t,e){this.state.content!==e.content&&this.state.onUpdated&&this.state.onUpdated.call(this)},render:function(){var t="";return this.state.episodeNum&&this.state.count&&(t=React.createElement("a",{href:this.state.moreURL,ref:"moreLink"},"> 第"+this.state.episodeNum+"集讨论共"+this.state.count+"条")),React.createElement("div",null,React.createElement("div",{className:this.props.containerCSS,id:this.props.id,dangerouslySetInnerHTML:{__html:this.state.content}}),t)}}),list=$(".mv-discussion-list"),recentContent=list.html(),hotContent=$(".mv-hot-discussion-list").html(),episode=ReactDOM.render(React.createElement(EpisodeDiscussion,{dataSource:"/j/discussion/episode_discussions"}),list[0]);episode.setContent(recentContent);var nav=$(".mv-discussion-nav");nav.bind("mousewheel DOMMouseScroll",function(t){var e=t.originalEvent,s=this.scrollTop,n=nav[0].scrollHeight-nav.height();if(0!=n)return s+=1*((e.wheelDelta||-e.detail)<0?1:-1),s<=0?(nav.scrollTop(0),!1):s>=n?(nav.scrollTop(n),!1):void 0}),nav.delegate("a","click",function(t){t.preventDefault();var e=$(this),s=e.data("epid");if(s&&"more"==s)return e.remove(),void nav.find(".more-item").removeClass("more-item");if(nav.find(".on").removeClass("on"),!s||"hot"==s){s?nav.find("a:eq(1)").addClass("on"):nav.find("a:eq(0)").addClass("on"),episode.setState({episodeNum:null});var n=s?hotContent:recentContent;return void episode.setContent(n)}episode.setState({moreURL:e.attr("href"),episodeNum:e.data("num")}),episode.onUpdated(function(){nav.find("[data-num="+this.state.episodeNum+"]").addClass("on")}),episode.fetch(s)});
  }
);
;
                !function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(t){return e[t]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=40)}([function(e,t,n){"use strict";function r(e){return"[object Array]"===s.call(e)}function o(e){return null!==e&&"object"==typeof e}function i(e){return"[object Function]"===s.call(e)}function a(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}var u=n(8),c=n(16),s=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:c,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:i,isStream:function(e){return o(e)&&i(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:a,merge:function e(){function t(t,r){"object"==typeof n[r]&&"object"==typeof t?n[r]=e(n[r],t):n[r]=t}for(var n={},r=0,o=arguments.length;r<o;r++)a(arguments[r],t);return n},extend:function(e,t,n){return a(t,function(t,r){e[r]=n&&"function"==typeof t?u(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";n.r(t),n.d(t,"challengeKeyInterceptor",function(){return o});var r=n(13),o=function(e){var t=r.get("ck");return"get"===e.method||"delete"===e.method?(e.params=e.params||{},e.params.ck=t):(e.data=e.data||{},e.data.ck=t),e}},function(e,t,n){"use strict";(function(t){function r(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o,i=n(0),a=n(19),u={"Content-Type":"application/x-www-form-urlencoded"},c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t)&&(o=n(9)),o),transformRequest:[function(e,t){return a(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],function(e){c.headers[e]={}}),i.forEach(["post","put","patch"],function(e){c.headers[e]=i.merge(u)}),e.exports=c}).call(this,n(18))},function(e,t,n){"use strict";n.r(t),n.d(t,"restfulTransformInterceptor",function(){return o});var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=function(e){var t=e.url,n=e.params,o=e.method,i=e.data,a=t||"",u=o||"",c=["get","delete"].indexOf(u)>=0?r({},n):r({},i);a=Object.keys(c).reduce(function(e,t){if(void 0===c[t]||null===c[t]||"string"!=typeof c[t]&&"number"!=typeof c[t])return e;var n=new RegExp(":"+t,"g");if(!e.match(n))return e;var r=c[t];return delete c[t],e.replace(n,r)},a);var s=r({},e);return s.url=a,["get","delete"].indexOf(u)>=0?s.params=c:s.data=c,s}},function(e,t,n){"use strict";n.r(t),n.d(t,"dataStringInterceptor",function(){return o});var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=function(e){var t=e.method,n=e.data;if(t&&"POST"!==t.toUpperCase()&&"PUT"!==t.toUpperCase())return e;var o=r({},e);return o.data=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=Object.assign({},e);return n&&Object.keys(r).map(function(e){void 0!==r[e]&&null!==r[e]||delete r[e]}),Object.keys(r).map(function(e){return t?e+"="+encodeURIComponent(r[e]):e+"="+r[e]}).join("&")}(n||{}),o}},function(e,t,n){"use strict";function r(e,t){function n(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function i(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function a(e,t){return function(n,r){t(n,r,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}c((r=r.apply(e,t||[])).next())})}function s(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(i=u.trys,!((i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){u.label=n[1];break}if(6===n[0]&&u.label<i[1]){u.label=i[1],i=n;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(n);break}i[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,o,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function f(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||E(t,e,n)}function l(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function d(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function h(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function y(e,t,n){function r(e){s[e]&&(c[e]=function(t){return new Promise(function(n,r){f.push([e,t,n,r])>1||o(e,t)})})}function o(e,t){try{(n=s[e](t)).value instanceof m?Promise.resolve(n.value.v).then(i,a):u(f[0][2],n)}catch(e){u(f[0][3],e)}var n}function i(e){o("next",e)}function a(e){o("throw",e)}function u(e,t){e(t),f.shift(),f.length&&o(f[0][0],f[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,s=n.apply(e,t||[]),f=[];return c={},r("next"),r("throw"),r("return"),c[Symbol.asyncIterator]=function(){return this},c}function v(e){function t(t,o){n[t]=e[t]?function(n){return(r=!r)?{value:m(e[t](n)),done:"return"===t}:o?o(n):n}:o}var n,r;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n}function g(e){function t(t){n[t]=e[t]&&function(n){return new Promise(function(r,o){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,o,(n=e[t](n)).done,n.value)})}}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=e[Symbol.asyncIterator];return r?r.call(e):(e=l(e),n={},t("next"),t("throw"),t("return"),n[Symbol.asyncIterator]=function(){return this},n)}function b(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&E(t,e,n);return C(t,e),t}function w(e){return e&&e.__esModule?e:{default:e}}function x(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function S(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}n.r(t),n.d(t,"__extends",function(){return r}),n.d(t,"__assign",function(){return T}),n.d(t,"__rest",function(){return o}),n.d(t,"__decorate",function(){return i}),n.d(t,"__param",function(){return a}),n.d(t,"__metadata",function(){return u}),n.d(t,"__awaiter",function(){return c}),n.d(t,"__generator",function(){return s}),n.d(t,"__createBinding",function(){return E}),n.d(t,"__exportStar",function(){return f}),n.d(t,"__values",function(){return l}),n.d(t,"__read",function(){return p}),n.d(t,"__spread",function(){return d}),n.d(t,"__spreadArrays",function(){return h}),n.d(t,"__await",function(){return m}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return v}),n.d(t,"__asyncValues",function(){return g}),n.d(t,"__makeTemplateObject",function(){return b}),n.d(t,"__importStar",function(){return _}),n.d(t,"__importDefault",function(){return w}),n.d(t,"__classPrivateFieldGet",function(){return x}),n.d(t,"__classPrivateFieldSet",function(){return S});var O=function(e,t){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},T=function(){return(T=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},E=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},C=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}},function(e,t,n){function r(e,t,n,r,i){var a=o.apply(this,arguments);return e.addEventListener(n,a,i),{destroy:function(){e.removeEventListener(n,a,i)}}}function o(e,t,n,r){return function(n){n.delegateTarget=i(n.target,t),n.delegateTarget&&r.call(e,n)}}var i=n(33);e.exports=function(e,t,n,o,i){return"function"==typeof e.addEventListener?r.apply(null,arguments):"function"==typeof n?r.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return r(e,t,n,o,i)}))}},function(e,t,n){e.exports=n(15)},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(0),o=n(20),i=n(22),a=n(23),u=n(24),c=n(10);e.exports=function(e){return new Promise(function(t,s){var f=e.data,l=e.headers;r.isFormData(f)&&delete l["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",h=e.auth.password||"";l.Authorization="Basic "+btoa(d+":"+h)}if(p.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:n,config:e,request:p};o(t,s,r),p=null}},p.onerror=function(){s(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){s(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var m=n(25),y=(e.withCredentials||u(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;y&&(l[e.xsrfHeaderName]=y)}if("setRequestHeader"in p&&r.forEach(l,function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete l[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),s(e),p=null)}),void 0===f&&(f=null),p.send(f)})}},function(e,t,n){"use strict";var r=n(21);e.exports=function(e,t,n,o,i){var a=new Error(e);return r(a,t,n,o,i)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){var r,o;!function(i){if(void 0===(o="function"==typeof(r=i)?r.call(t,n,t,e):r)||(e.exports=o),e.exports=i(),!1){var a=window.Cookies,u=window.Cookies=i();u.noConflict=function(){return window.Cookies=a,u}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var c in i)i[c]&&(u+="; "+c,!0!==i[c]&&(u+="="+i[c].split(";")[0]));return document.cookie=t+"="+n+u}}function a(e,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var u=i[a].split("="),c=u.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var s=t(u[0]);if(c=(r.read||r)(c,s)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(o[s]=c,e===s)break}catch(e){}}return e?o[e]:o}}return o.set=i,o.get=function(e){return a(e,!1)},o.getJSON=function(e){return a(e,!0)},o.remove=function(t,n){i(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}(function(){})})},function(e,t,n){"use strict";n.r(t),n.d(t,"challengeKeyInterceptor",function(){return i.challengeKeyInterceptor}),n.d(t,"restfulTransformInterceptor",function(){return a.restfulTransformInterceptor}),n.d(t,"dataStringInterceptor",function(){return u.dataStringInterceptor}),n.d(t,"axios",function(){return o.a});var r=n(7),o=n.n(r),i=n(1),a=n(3),u=n(4)},function(e,t,n){"use strict";function r(e){var t=new a(e),n=i(a.prototype.request,t);return o.extend(n,a.prototype,t),o.extend(n,t),n}var o=n(0),i=n(8),a=n(17),u=n(2),c=r(u);c.Axios=a,c.create=function(e){return r(o.merge(u,e))},c.Cancel=n(12),c.CancelToken=n(31),c.isCancel=n(11),c.all=function(e){return Promise.all(e)},c.spread=n(32),e.exports=c,e.exports.default=c},function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new a,response:new a}}var o=n(2),i=n(0),a=n(26),u=n(27);r.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(o,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[u,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},i.forEach(["delete","get","head","options"],function(e){r.prototype[e]=function(t,n){return this.request(i.merge(n||{},{method:e,url:t}))}}),i.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(i.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=r},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(s===setTimeout)return setTimeout(e,0);if((s===n||!s)&&setTimeout)return s=setTimeout,setTimeout(e,0);try{return s(e,0)}catch(t){try{return s.call(null,e,0)}catch(t){return s.call(this,e,0)}}}function i(){h&&p&&(h=!1,p.length?d=p.concat(d):m=-1,d.length&&a())}function a(){if(!h){var e=o(i);h=!0;for(var t=d.length;t;){for(p=d,d=[];++m<t;)p&&p[m].run();m=-1,t=d.length}p=null,h=!1,function(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var s,f,l=e.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:n}catch(e){s=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var p,d=[],h=!1,m=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new u(e,t)),1!==d.length||h||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=c,l.addListener=c,l.once=c,l.off=c,l.removeListener=c,l.removeAllListeners=c,l.emit=c,l.prependListener=c,l.prependOnceListener=c,l.listeners=function(e){return[]},l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(10);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(0);e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(o.isURLSearchParams(t))i=t.toString();else{var a=[];o.forEach(t,function(e,t){null!=e&&(o.isArray(e)?t+="[]":e=[e],o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),a.push(r(t)+"="+r(e))}))}),i=a.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t,n){"use strict";var r=n(0),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,a={};return e?(r.forEach(e.split("\n"),function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}}),a):a}},function(e,t,n){"use strict";var r=n(0);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=r.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(0);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,a){var u=[];u.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),r.isString(o)&&u.push("path="+o),r.isString(i)&&u.push("domain="+i),!0===a&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";function r(){this.handlers=[]}var o=n(0);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=n(0),i=n(28),a=n(11),u=n(2),c=n(29),s=n(30);e.exports=function(e){return r(e),e.baseURL&&!c(e.url)&&(e.url=s(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||u.adapter)(e).then(function(t){return r(e),t.data=i(t.data,t.headers,e.transformResponse),t},function(t){return a(t)||(r(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=n(12);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r(function(t){e=t}),cancel:e}},e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t){if("undefined"!=typeof Element&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},function(e,t,n){"use strict";function r(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function o(e,t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=r(e.className,t):e.setAttribute("class",r(e.className&&e.className.baseVal||"",t))}n.r(t),n.d(t,"default",function(){return o})},function(e,t,n){"use strict";function r(e,t){e.classList?e.classList.add(t):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(e,t)||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}n.r(t),n.d(t,"default",function(){return r})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createVoteHandler=t.VoteHandler=t.DEFAULT_CONFIG=void 0;var r=n(5),o=n(14),i=n(4),a=n(1),u=n(3),c=r.__importDefault(n(6)),s=o.axios.create({withCredentials:!0});s.interceptors.request.use(i.dataStringInterceptor),s.interceptors.request.use(a.challengeKeyInterceptor),s.interceptors.request.use(u.restfulTransformInterceptor),t.DEFAULT_CONFIG={is_released:!0,alert_text:"还未上映，不能投票",root:document.getElementById("comments"),voteSelector:".vote-comment",textSelector:".vote-count",api:"/j/comment/vote"};var f=function(){function e(e){this.config=r.__assign(r.__assign({},t.DEFAULT_CONFIG),e),this._init()}return e.prototype._init=function(){var e=this.config,t=e.is_released,n=e.alert_text,r=e.root,o=e.voteSelector,i=e.textSelector,a=e.api,u=e.afterVote;console.log("voteSelector",o),c.default(r,o,"click",function(e){var r;console.log("vote click");var o=e.srcElement;if(e.preventDefault(),!t)return alert(n),!1;var c=o.getAttribute("data-id")||o.getAttribute("data-cid"),f=null===(r=o.parentNode)||void 0===r?void 0:r.querySelector(i);s.post(a,{id:c}).then(function(e){var t=e.data,n=t.r,r=t.count,i=t.msg;0===n&&r?(f&&(f.innerHTML=r),u&&u(o,e.data)):0!==n&&i&&alert(i)})})},e}();t.VoteHandler=f,t.createVoteHandler=function(e){return new f(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createExpandHandler=t.ExpandHandler=t.DEFAULT_CONFIG=void 0;var r=n(5),o=r.__importDefault(n(6)),i=r.__importDefault(n(35)),a=r.__importDefault(n(34));t.DEFAULT_CONFIG={root:document.getElementById("comments"),expandSelector:".expand a"};var u=function(){function e(e){this.config=r.__assign(r.__assign({},t.DEFAULT_CONFIG),e),this._init()}return e.prototype._init=function(){var e=this.config,t=e.root,n=e.expandSelector;o.default(t,n,"click",function(e){var t;e.preventDefault();var n=e.target,r=null===(t=n.parentElement)||void 0===t?void 0:t.parentElement;r.getAttribute("data-expand")?(n.innerHTML="展开",a.default(r,"expanded"),r.setAttribute("data-expand","")):(n.innerHTML="收起",i.default(r,"expanded"),r.setAttribute("data-expand","expand"))})},e}();t.ExpandHandler=u,t.createExpandHandler=function(e){return new u(e)}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(41);var r=n(36),o=n(37),i=n(42),a=window;a.SUBJECT_COMMENTS_SECTION=a.SUBJECT_COMMENTS_SECTION||{},a.SUBJECT_COMMENTS_SECTION.createExpandHandler=o.createExpandHandler,a.SUBJECT_COMMENTS_SECTION.createVoteHandler=r.createVoteHandler,a.SUBJECT_COMMENTS_SECTION.createTabHandler=i.createTabHandler},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTabHandler=t.TabHandler=t.DEFAULT_CONFIG=void 0;var r=n(5),o=r.__importDefault(n(6)),i=r.__importDefault(n(35)),a=r.__importDefault(n(34));t.DEFAULT_CONFIG={root:document.getElementById("comments-section"),tabSelector:".short-comment-tabs",tabTargetSelector:".comment-list"};var u=function(){function e(e){this.config=r.__assign(r.__assign({},t.DEFAULT_CONFIG),e),this._init()}return e.prototype._init=function(){var e=this.config,t=e.root,n=e.tabSelector,r=e.tabTargetSelector,u=t.querySelectorAll(r),c=t.querySelectorAll(n);o.default(t,n,"click",function(e){e.preventDefault();var t=e.target,n=t.getAttribute("data-tab");c.forEach(function(e){e!==t?a.default(e,"on-tab"):i.default(e,"on-tab")}),u.forEach(function(e){console.log("tabName: "+n),console.log("id: "+e.id),e.id===n?(i.default(e,"show"),a.default(e,"hide")):(i.default(e,"hide"),a.default(e,"show"))})})},e}();t.TabHandler=u,t.createTabHandler=function(e){return new u(e)}}]);
                (function () {
                    if (window.SUBJECT_COMMENTS_SECTION) {
                        // tab handler
                        SUBJECT_COMMENTS_SECTION.createTabHandler();
                        // expand handler
                        SUBJECT_COMMENTS_SECTION.createExpandHandler({
                            root: document.getElementById('comments-section'),
                        });
                        // vote handler
                        SUBJECT_COMMENTS_SECTION.createVoteHandler({
                            api: '/j/comment/vote',
                            root: document.getElementById('comments-section'),
                            voteSelector: '.vote-comment',
                            textSelector: '.vote-count',
                            is_released: "true",
                            alert_text: "该剧尚未播出，不能投票噢",
                            afterVote: function (elem) {
                                var parentNode = elem.parentNode;
                                var successElem = document.createElement('span');
                                successElem.innerHTML = '已投票';
                                parentNode.removeChild(elem);
                                parentNode.appendChild(successElem);
                            }
                        });
                    }
                })();
            